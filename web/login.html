<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ClawDaemon ‚Äî Login</title>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    background: #0d1117; color: #e6edf3;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    display: flex; align-items: center; justify-content: center;
    min-height: 100vh;
  }
  .card {
    background: #161b22; border: 1px solid #30363d;
    border-radius: 12px; padding: 40px; width: 100%; max-width: 380px;
  }
  h1 { font-size: 1.5rem; margin-bottom: 8px; color: #58a6ff; }
  .subtitle { color: #8b949e; font-size: 0.9rem; margin-bottom: 28px; }
  label { display: block; font-size: 0.85rem; color: #8b949e; margin-bottom: 6px; }
  input {
    width: 100%; padding: 10px 14px;
    background: #0d1117; border: 1px solid #30363d; border-radius: 6px;
    color: #e6edf3; font-size: 0.95rem; margin-bottom: 16px;
    outline: none; transition: border-color 0.2s;
  }
  input:focus { border-color: #58a6ff; }
  button {
    width: 100%; padding: 11px;
    background: #1f6feb; color: #fff; border: none;
    border-radius: 6px; font-size: 1rem; cursor: pointer;
    transition: background 0.2s;
  }
  button:hover { background: #388bfd; }
  button:disabled { background: #21262d; color: #8b949e; cursor: not-allowed; }
  .error {
    background: #3d1f1f; border: 1px solid #f85149;
    color: #f85149; border-radius: 6px; padding: 10px 14px;
    font-size: 0.88rem; margin-bottom: 16px; display: none;
  }
  .locked {
    background: #2d2208; border: 1px solid #d29922;
    color: #d29922; border-radius: 6px; padding: 10px 14px;
    font-size: 0.88rem; margin-bottom: 16px; display: none;
  }
  .logo { font-size: 2rem; margin-bottom: 12px; }
</style>
</head>
<body>
<div class="card">
  <div class="logo">üêæ</div>
  <h1>ClawDaemon</h1>
  <p class="subtitle">AI Agent Orchestrator</p>
  <div class="error" id="error"></div>
  <div class="locked" id="locked">‚ö†Ô∏è Too many failed attempts. Please wait 15 minutes.</div>
  <form id="loginForm">
    <label for="username">Username</label>
    <input type="text" id="username" autocomplete="username" placeholder="admin" required>
    <label for="password">Password</label>
    <input type="password" id="password" autocomplete="current-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
    <button type="submit" id="btn">Sign in</button>
  </form>
</div>
<script>
document.getElementById('loginForm').addEventListener('submit', async (e) => {
  e.preventDefault();
  const btn = document.getElementById('btn');
  const errEl = document.getElementById('error');
  const lockedEl = document.getElementById('locked');
  errEl.style.display = 'none';
  lockedEl.style.display = 'none';
  btn.disabled = true;
  btn.textContent = 'Signing in‚Ä¶';
  try {
    const res = await fetch('/api/v1/auth/login', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        username: document.getElementById('username').value,
        password: document.getElementById('password').value
      })
    });
    const data = await res.json();
    if (data.success) {
      window.location.href = data.data?.requires_2fa ? '/2fa' : '/';
    } else {
      if (data.error && data.error.includes('blocked')) {
        lockedEl.style.display = 'block';
      } else {
        errEl.textContent = data.error || 'Invalid credentials.';
        errEl.style.display = 'block';
      }
    }
  } catch (err) {
    errEl.textContent = 'Network error. Please try again.';
    errEl.style.display = 'block';
  } finally {
    btn.disabled = false;
    btn.textContent = 'Sign in';
  }
});
</script>
</body>
</html>
